## PyBirch
<p align="center">
  <img src="birch.png" alt="PyBirch" width="200"/>
</p>
  
Laboratory measurement architecture. Integrates with PyMeasure instruments to run scans over arbitrary dimensions, all from a simple, intuitive GUI. Tracks sample fabrication history using LablinQR extension; and passes data to a Wandb interface for real-time data visualization, storage and management.

### Database Web Interface

PyBirch includes a built-in database web application for managing laboratory resources. The database provides:

- **Sample Management**: Track samples with fabrication history, QR codes for physical labeling, and linked procedures
- **Precursor Tracking**: Manage chemical precursors with lot numbers, suppliers, and safety information
- **Equipment Registry**: Catalog laboratory equipment with maintenance schedules and documentation
- **Procedure Library**: Store and version fabrication procedures with step-by-step instructions
- **Project Organization**: Group related samples, equipment, and procedures by project
- **Issue Tracking**: Built-in issue reporting for bugs and feature requests
- **User Authentication**: Google OAuth integration for secure access

To run the database web interface:
```bash
cd database
python run_web.py
```
Then visit `http://127.0.0.1:5000` in your browser.

### Roadmap

Items:
- [x] Python Backend
- [x] WanDB Integration
- [x] Integration of PyMeasure Instruments
- [x] Movement Objects
- [x] Measurement Objects
- [x] Test Scan
- [x] Available Instruments List
- [x] Scan Tree Logic
- [x] Scan Tree UI
- [x] Adapter autoload
- [x] Instrument select window
- [x] Instrument + Adapter autopair
- [x] Settings Panels for Preliminary Instruments
- [x] Autogenerated Settings Table for PyMeasure Instruments
- [x] Scan List -- Deprecated
- [x] Queue Title Bar
- [x] Instrument Autoload
- [x] Main Scan Page
- [x] User Fields Box
- [x] Instrument Page Serialization
- [x] Scan Serialization
- [x] Queue Serialization
- [x] Scan Info Page
- [x] Queue Info Page
- [x] Scan Presets
- [x] Queue Presets
- [x] Queue Logic
- [ ] Documentation
- [ ] Conditional Object
- [ ] Advanced Movement Object
- [ ] User Alphatest
- [ ] Revamp UI with Yusuke Kamiyamane icons
- [ ] Finalize code structure
- [x] Pinecone Database
- [x] Database Web Interface
- [ ] **GUI-Database Integration** (see [docs/GUI_DATABASE_INTEGRATION.md](docs/GUI_DATABASE_INTEGRATION.md))
- [ ] Maybe: Autogenerate Acquisition, Movement objects from PyMeasure instruments
- [ ] Maybe: Autofind devices using 2D scans, add folder for data passing between scans...



- [ ] ask members of teams
- [x] Add the ability to individually delete all types of database objects in the UI
- [x] allow visualizations to be saved into the images section of the corresponding sample
- [x] allow users to edit scans and queues to add links to samples and projects that may be missing
- [x] For image uploads in general, remove the drag & drop box (it is too large & clutters the UI), instead allow users to drop images onto the gallery (as is standard in other well-established applications)
- [x] add QR code option beside all search-select dropdowns that allows a QR code to be scanned, and inputs the resulting object if it is of the correct type, etc.
- [ ] Add file uploads with optional name & description. The UI should be like image uploads are currently, with drag and drop over the section & manual file selection options. These should be implemented everywhere image uploads are allowed. Acccept all standard file types, as well as scientific types like .kdf design files, gwiddeon afm files, etc. Make adding new acceptable file types easy to do (in case it is necessary for developers in the future.)
- [ ] add recurring maintenance tasks to equipment, which open a maintenance issue after a given wait, and begin the wait again after that issue is resolved

- [ ] allow to share equipment with users or with labs. They may create issues and view the equipment & its issues, but that is all.
- [ ] ability to pin image
- [ ] add multiple y values and legend for line plot
- [ ] Automations -- emails, slack notifications, api calls to other databases; simple / template configurable
- [ ] notifications for users (essentially preset automations) which can be enables in email or slack for any of: scan status change, queue status change, issue assignment, assigned issue status change, assigned equipment status change, site-wide issue status change, new creation of new issues).
- [ ] notifications for a slack channel as well, with the same settings as if it were a user, minus the assignment specific notifications. Objects are hyperlinked as with references. Includes user who made the change, if applicable
- [ ] maybe recipient class, with items like slack channels or email groups. user email & slack notifications are treated as a recipient with one address (only difference is that it is edited in the profile). can be configured with standard/custom notifications upon various lab events
- [ ] references -- to be used in descriptions, etc. (popup search window?)
- [ ] waste objects
- [ ] dark mode xD
- [ ] email notifications when members are added to labs/projects
- [ ] Lab door access logs for security
- [ ] Equipment usage logs, interface with iLab & calendar
- [ ] equipment usage scheduling, google calendar
- [ ] user qr code for login
- [x] archive feature to hide old objects unless specifically allowed in the site-wide filters
- [ ] starred objects. appear first, after pins. database wide, not per user. starred images as well.

- [x] add file and image uploads to fabrication runs
- [ ] add settings change object to scans

- [ ] separate axis names and units, these should be added to the downloadable csv file in the form name (units). Fix automatic visualization titles & axes appropriately.
- [ ] add description field to images
- [ ] add ability to upload other files (.kdf, gwiddeon, pdf, json, etc.) with name & description
- [ ] add a team to the member heirarchy
- [ ] allow sharing between labs, when accepted will add the other lab as a link to the object, and give permissions to related objects (scans, samples)
- [ ] add analyses, json import for now. includes cisualization functionality from scan data, can save images to scan. add rest api for future automations here
- [ ] allow users to add sample/project after a scan/queue is run by editing in the db.
- [ ] Add a "number of measurements" option for measurement objects. This will be configured like movement object positions (will require similar cards to be made for the scan setup page, that are visible when the measurement is selected in the scan tree GUI).

- [x] allow users to change default values in fabrication runs (if they are tuning something)
- [x] make parameters in procedures dynamic & configurable. e.g. deposition vs. photolithography will use a completely different set of parameters.
- [x] make equipment types dynamic & configurable within a lab (i.e. should be able to add new types, which will populate in the dropdown.)

- [ ] Add images to labs (so i can add the cute group photo)

- [ ] Site-wide filters need to be edited -- the button is visible longer than the Ui bar that it opens (frustrating)
- [ ] allow users to choose a lab in their profile, filters everything. allow labs to turn on/off database items they don't use -- wont show up in navlinks or index when that lab is selected for viewing in the user profile. allow labs to configure a custom color theme (three or four primary colors) that will be used when that lab is selected for viewing.
- [ ] publications -- link to scans, samples, lab, users, etc. Allows users to censor appropriately for a publically visible object that could be linked to from an actual publication (i.e. not to show description/notes on samples).
- [ ] User statistics (labs created, samples created, etc. issues closed, publcations featured in, images added, and some other cool ones (pages visited? idk))
- [ ] Autogenerated monthly summaries (created, deleted object numbers). # of resolved issues by type, split by object type (equipment, insturment, etc.). Upcoming maintenance tasks. Open issues. Plots of failed fabrication runs, and histogram of their failure modes (if there is enough data >10?). Users can select which of these they want to receive with checkboxes.

- [ ] Eventually: add automatic report generation that pulls from starred object
- [ ] Eventually: add the possibility to configure a small subset of lab objects to be made public  (available to all users to view, not just those with permissions). This will be like a lab website or group page. 
- [ ] Eventually: live polling to connected computers, ability to query to instruments from instrument detail page & check connection there. ability to start scans from other devices via connection through pybirch. Ability to check whether computers are connected. of course, computers need to be first class database objects for this to make sense.
- [ ] Eventually: migrate pybirch to jshtml with api
