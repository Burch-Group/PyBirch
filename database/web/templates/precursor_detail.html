{% extends "base.html" %}
{% from "macros.html" import detail_action_buttons %}

{% block title %}{{ precursor.name }} - PyBirch Database{% endblock %}

{% block content %}
<div class="detail-page">
    <div class="page-header">
        <div class="breadcrumb">
            <a href="{{ url_for('main.precursors') }}">Precursors</a> / {{ precursor.name }}
        </div>
    </div>
    
    <div class="detail-header">
        <h1>{{ precursor.name }}</h1>
        <div class="detail-actions">
            {% if precursor.status %}
            <span class="status-badge status-{{ precursor.status }}">{{ precursor.status }}</span>
            {% endif %}
            {{ detail_action_buttons(
                edit_url=url_for('main.precursor_edit', precursor_id=precursor.id),
                duplicate_url=url_for('main.precursor_duplicate', precursor_id=precursor.id),
                entity_type='precursor',
                entity_id=precursor.id,
                show_archive=false,
                show_trash=false
            ) }}
        </div>
    </div>
    
    <!-- QR Code Section -->
    <div class="qr-code-section">
        <div class="qr-code-preview">
            <img src="{{ url_for('main.precursor_qrcode_preview', precursor_id=precursor.id) }}" 
                 alt="QR Code for {{ precursor.name }}" 
                 class="qr-code-img">
        </div>
        <a href="{{ url_for('main.precursor_qrcode', precursor_id=precursor.id) }}" 
           class="btn btn-secondary btn-small" download>
            ðŸ“¥ Download QR Code
        </a>
    </div>
    
    <div class="detail-grid">
        <div class="detail-section">
            <h2>Chemical Information</h2>
            <dl class="detail-list">
                <dt>Chemical Formula</dt>
                <dd><code>{{ precursor.chemical_formula or '-' }}</code></dd>
                
                <dt>CAS Number</dt>
                <dd>{{ precursor.cas_number or '-' }}</dd>
                
                <dt>Purity</dt>
                <dd>{{ (precursor.purity | string) + '%' if precursor.purity else '-' }}</dd>
                
                <dt>State</dt>
                <dd>{{ precursor.state or '-' }}</dd>
                
                <dt>Concentration</dt>
                <dd>
                    {% if precursor.concentration %}
                        {{ precursor.concentration }} {{ precursor.concentration_unit or '' }}
                    {% else %}
                        -
                    {% endif %}
                </dd>
            </dl>
        </div>
        
        <div class="detail-section">
            <h2>Supply & Storage</h2>
            <dl class="detail-list">
                <dt>Supplier</dt>
                <dd>{{ precursor.supplier or '-' }}</dd>
                
                <dt>Lot Number</dt>
                <dd>{{ precursor.lot_number or '-' }}</dd>
                
                <dt>Expiration Date</dt>
                <dd>{{ precursor.expiration_date or '-' }}</dd>
                
                <dt>Storage Conditions</dt>
                <dd>{{ precursor.storage_conditions or '-' }}</dd>
                
                <dt>Added</dt>
                <dd>{{ precursor.created_at[:10] if precursor.created_at else '-' }}</dd>
            </dl>
        </div>
        
        <div class="detail-section">
            <h2>Organization</h2>
            <dl class="detail-list">
                <dt>Lab</dt>
                <dd>
                    {% if precursor.lab %}
                    <a href="{{ url_for('main.lab_detail', lab_id=precursor.lab.id) }}">{{ precursor.lab.name }}</a>
                    {% else %}
                    -
                    {% endif %}
                </dd>
                
                <dt>Project</dt>
                <dd>
                    {% if precursor.project %}
                    <a href="{{ url_for('main.project_detail', project_id=precursor.project.id) }}">{{ precursor.project.name }}</a>
                    {% else %}
                    -
                    {% endif %}
                </dd>
            </dl>
        </div>
    </div>
    
    <!-- Images Section -->
    {% include 'partials/image_gallery.html' %}
</div>
{% endblock %}
